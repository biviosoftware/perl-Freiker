# Copyright (c) 2009 bivio Software, Inc.  All Rights Reserved.
# $Id$
test_setup('Freiker');
my($e, $z) = register_random('family');
login_as($e);
verify_form({
    miles => '',
});
follow_link('settings');
verify_form({
    post => $z,
    country => 'US',
});
submit_form({
    post => 'QXM 555',
    country => 'CA',
});
follow_link('your_family');
test_deviance(qr{is already assigned});
submit_form({
    first => 'Bruce',
    '^zaptag' => 1234,
    '^school' => 'bunit Elementary',
    kilometers => 17,
});
test_conformance();
submit_form({
    first => 'Bruce',
    middle => 'A',
    last => my $last = random_string(),
    '^zaptag' => 1237,
    '^school' => 'bunit Elementary',
    kilometers => 17,
});
follow_link('your_family');
follow_link('edit_info');
submit_form({
    first => 'Milton',
});
verify_table(Kid => [
    ['Kid'],
    ['Milton'],
]);
follow_link(qw(your_family register_kid));
submit_form({
    first => 'Larry',
    '^zaptag' => 1238,
    '^school' => 'bunit Elementary',
    kilometers => 3,
});
verify_text('Larry');
login_as('wheel');
submit_form(Refresh => {
    dates => '01/01/2000',
    to => Type_Date()->to_string(Type_Date()->local_today),
});
follow_link_in_table('kid', 'kid', "$last, Milton A", 'action', 'info');


