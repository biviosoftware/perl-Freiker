# Copyright (c) 2007 bivio Software, Inc.  All Rights Reserved.
# $Id$
test_setup('Freiker');
my($e, $z) = register_random('wheel');
login_as('adm');
follow_link(qr{^register.*school}i);
submit_form({
    name => my $name = "School $z",
    number => 10,
    website => "http://school$z.org",
    '1.$' => "$z My Street",
    city => 'y',
    state => 'co',
    post => $z,
});
follow_link('codes');
my($floor) = int($z / 10000) * 10000 + 2000;
my($codes) = [map(random_integer($floor + 8000, $floor), 1..10)];
my($epcs) = [map(sprintf('%016X%08X',  $z, $_), @$codes)];
submit_form({
    csv => file_field('any.csv', join(
	'',
	"EPC,Print\n",
	map(sprintf("%s,%d\n", $epcs->[$_], $codes->[$_]), 0 .. $#$codes),
    )),
});
verify_text($codes->[0]);
follow_link('available_prizes');
