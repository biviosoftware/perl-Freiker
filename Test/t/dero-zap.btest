# Copyright (c) 2009 bivio Software, Inc.  All Rights Reserved.
# $Id$
test_setup('Freiker');
home_page();
# login_as('adm');
# follow_link(qw(^site$ files));
# send_request(DELETE => '/dav/site/Files/zap.dat')
#     if text_exists('zap.dat');
# do_logout();
# #basic_authorization('fm_dero_zap');
# my($expect) = 'btest=' . random_string();
# send_request(POST => "/dz", undef, $expect);
# home_page();
# login_as('adm');
# follow_link(qw(^site$ files zap.dat));
# test_equals($expect, get_content());


my($content) = 'StationId=00%3AD0%3A69%3A41%3AF1%3AFA&BikeDateTime0=1257022945&RfidNum0=465245494B4552010008AF5B&BikeDateTime1=1257022945&RfidNum1=465245494B4552010008941D&BikeDateTime2=1257022945&RfidNum2=465245494B45520100088F9C&BikeDateTime3=1257022945&RfidNum3=465245494B4552010008949B&BikeDateTime4=1257022945&RfidNum4=465245494B4552010008948D&BikeDateTime5=1257022945&RfidNum5=465245494B4552010008A2F3&BikeDateTime6=1257022946&RfidNum6=465245494B4552010008941D&BikeDateTime7=1257022946&RfidNum7=465245494B4552010008AF5B&BikeDateTime8=1257022947&RfidNum8=465245494B4552010008941D&BikeDateTime9=1257022948&RfidNum9=465245494B4552010008941D&BikeDateTime10=1257022949&RfidNum10=465245494B4552010008941D&BikeDateTime11=1257022950&RfidNum11=465245494B4552010008941D&BikeDateTime12=1257022951&RfidNum12=465245494B45520100088F9C&BikeDateTime13=1257022951&RfidNum13=465245494B4552010008948D&BikeDateTime14=1257022951&RfidNum14=465245494B4552010008AF5B&BikeDateTime15=1257022951&RfidNum15=465245494B4552010008941D&BikeDateTime16=1257022951&RfidNum16=465245494B4552010008A2F3&BikeDateTime17=1257022953&RfidNum17=465245494B4552010008AF5B&BikeDateTime18=1257022953&RfidNum18=465245494B4552010008A7D1&BikeDateTime19=1257022953&RfidNum19=465245494B45520100088F9C&BikeDateTime20=1257022953&RfidNum20=465245494B4552010008941D&BikeDateTime21=1257022954&RfidNum21=465245494B4552010008A7D1&BikeDateTime22=1257022954&RfidNum22=465245494B4552010008AF5B&BikeDateTime23=1257022954&RfidNum23=465245494B4552010008948D&BikeDateTime24=1257022954&RfidNum24=465245494B45520100088F9C&bikeEventCount=25&DateTime0=1257022911&EventCode0=4&RfidStatus0=0&Uptime0=4689&FirmwareVersion0=1&BatteryVoltage0=12.51&SolarOutput0=1.25&ChassisTemp0=25.95&statusEventCount=1';
send_request(POST => '/dz?date_time_test_now=01/01/2009', undef, $content);
do_test_backdoor(Btest => "read_log dz_00d06941f1fa/20090101145959");
test_ok(get_content() =~ qr{$content});
login_as('adm');
follow_link(qw(freikometers ^dz_00d06941f1fa$));
my($data) = eval {get_content()};
test_equals([
    ['465245494B4552010008AF5B', '20091031150225'],
    ['465245494B4552010008941D', '20091031150225'],
    ['465245494B45520100088F9C', '20091031150225'],
    ['465245494B4552010008949B', '20091031150225'],
    ['465245494B4552010008948D', '20091031150225'],
    ['465245494B4552010008A2F3', '20091031150225'],
    ['465245494B4552010008941D', '20091031150226'],
    ['465245494B4552010008AF5B', '20091031150226'],
    ['465245494B4552010008941D', '20091031150227'],
    ['465245494B4552010008941D', '20091031150228'],
    ['465245494B4552010008941D', '20091031150229'],
    ['465245494B4552010008941D', '20091031150230'],
    ['465245494B45520100088F9C', '20091031150231'],
    ['465245494B4552010008948D', '20091031150231'],
    ['465245494B4552010008AF5B', '20091031150231'],
    ['465245494B4552010008941D', '20091031150231'],
    ['465245494B4552010008A2F3', '20091031150231'],
    ['465245494B4552010008AF5B', '20091031150233'],
    ['465245494B4552010008A7D1', '20091031150233'],
    ['465245494B45520100088F9C', '20091031150233'],
    ['465245494B4552010008941D', '20091031150233'],
    ['465245494B4552010008A7D1', '20091031150234'],
    ['465245494B4552010008AF5B', '20091031150234'],
    ['465245494B4552010008948D', '20091031150234'],
    ['465245494B45520100088F9C', '20091031150234'],
], $data);


